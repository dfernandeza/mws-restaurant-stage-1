window.initMap=function(){fetchRestaurantFromURL(function(e,t){e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.fetchReviewsByRestaurant(self.restaurant.id,function(e,t){t&&(self.restaurant.reviews=t,fillReviewsHTML(self.restaurant.reviews))}),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})},document.getElementById("favorite").addEventListener("change",function(e){e.preventDefault(),self.restaurant&&DBHelper.markAsFavorite(self.restaurant.id,e.target.checked)}),document.getElementById("add-review-form").addEventListener("submit",function(r){r.preventDefault();var e=r.target.name.value,t=r.target.rating.value,n=r.target.comments.value;DBHelper.addReview({restaurant_id:self.restaurant.id,name:e,rating:t,comments:n},function(e,t){document.getElementById("reviews-list").appendChild(createReviewHTML(t)),r.target.reset()})}),fetchRestaurantFromURL=function(r){if(self.restaurant)r(null,self.restaurant);else{var e=getParameterByName("id");e?DBHelper.fetchRestaurantById(e,function(e,t){self.restaurant=self.restaurant||t,e?console.error(e):self.restaurant&&(fillRestaurantHTML(),r(null,self.restaurant))}):(error="No restaurant id in URL",r("No restaurant id in URL",null))}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;var t=document.getElementById("restaurant-img"),r=DBHelper.imageUrlForRestaurant(e,"sm"),n=DBHelper.imageUrlForRestaurant(e,"sm2x"),a=DBHelper.imageUrlForRestaurant(e);t.className="restaurant-img",t.src=DBHelper.imageUrlForRestaurant(e),t.srcset=r+" 320w, "+n+" 640w, "+a+" 800w",t.alt="Image of "+e.name+" restaurant",document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML();var i=document.getElementById("favorite");e.is_favorite&&i.setAttribute("checked","")},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours"),r=document.createElement("caption");for(var n in r.innerText="Restaurant Operating Hours",t.appendChild(r),e){var a=document.createElement("tr"),i=document.createElement("td");i.innerHTML=n,a.appendChild(i);var l=document.createElement("td");l.innerHTML=e[n],a.appendChild(l),t.appendChild(a)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container");if(0===t.querySelectorAll(".reviews-title").length){var r=document.createElement("h3");r.classList.add("reviews-title"),r.innerHTML="Reviews",t.appendChild(r)}if(!e){var n=document.createElement("p");return n.innerHTML="No reviews yet!",void t.appendChild(n)}var a=document.getElementById("reviews-list");a.innerHTML="",e.forEach(function(e){a.appendChild(createReviewHTML(e))}),t.appendChild(a)},createReviewHTML=function(e){var t=document.createElement("li"),r=document.createElement("p");r.innerHTML=e.name,t.appendChild(r);var n=document.createElement("p");n.innerHTML=new Date(e.createdAt).toLocaleString(),t.appendChild(n);var a=document.createElement("p");a.className="review__rating",a.innerHTML="Rating: "+e.rating,t.appendChild(a);var i=document.createElement("p");return i.innerHTML=e.comments,t.appendChild(i),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),r=document.createElement("li");r.innerHTML=e.name,r.setAttribute("aria-current","page"),t.appendChild(r)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null};
//# sourceMappingURL=restaurant-bundle.js.map
